---
title: Configurar ajustes del proveedor de OpenID Connect para un portal | MicrosoftDocs
description: Instrucciones para agregar y configurar las opciones del proveedor de OpenID Connect para un portal.
author: tapanm-msft
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: ''
ms.date: 10/18/2019
ms.author: tapanm
ms.reviewer: ''
ms.openlocfilehash: b36150e7193975305fb8a478852070628268d4ee
ms.sourcegitcommit: a0d069f63d2ce9496d578f81e65cd32bec2faa4d
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 01/23/2020
ms.locfileid: "2979225"
---
# <a name="configure-open-id-connect-provider-settings-for-portals"></a>Configurar proveedor Open ID Connect para portales

Los proveedores de identidad externos [Open ID Connect](https://openid.net/connect/) son servicios que se ajustan a las [especificaciones](https://openid.net/developers/specs/) de Open ID Connect. La integración de un proveedor implica buscar la dirección URL de la entidad (o emisor) asociada con el proveedor. Una dirección URL de configuración puede determinarse desde la entidad que suministra metadatos requeridos durante el flujo de trabajo de autenticación. Los valores de proveedores se basan en las propiedades de la clase [OpenIdConnectAuthenticationOptions](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.aspx).

Ejemplos de direcciones URL de entidad:

- [Google](https://developers.google.com/identity/protocols/OpenIDConnect): <https://accounts.google.com/><https://accounts.google.com/.well-known/openid-configuration>
- [[!INCLUDE[pn-azure-active-directory](../../../includes/pn-azure-active-directory.md)]](https://msdn.microsoft.com/library/azure/mt168838.aspx): [https://login.microsoftonline.com/&lt;[!INCLUDE[pn-azure-shortest](../../../includes/pn-azure-shortest.md)] Aplicación AD&gt;/](https://login.microsoftonline.com/contoso.onmicrosoft.com/.well-known/openid-configuration)

Cada proveedor de OpenID Connect también implica registrar una aplicación (similar al proveedor de OAuth 2.0) y obtener un Id. de cliente. La dirección URL de la autoridad y el id. de cliente de aplicación generado son los valores requeridos para habilitar la autenticación externa entre el portal y el proveedor de identidad.

> [!Note]
> El extremo Google OpenID Connect actualmente no es compatible porque las bibliotecas subyacentes aún se encuentran en las fases tempranas de lanzamiento con problemas de compatibilidad que resolver. En su lugar puede utilizarse el extremo de [configuración de proveedor OAuth2 para portales](configure-oauth2-settings.md).

## <a name="openid-settings-for-pn-azure-active-directory"></a>Configuración de OpenID para [!INCLUDE[pn-azure-active-directory](../../../includes/pn-azure-active-directory.md)]

Para empezar, inicie sesión en el Portal de administración de [[!INCLUDE[pn-azure-shortest](../../../includes/pn-azure-shortest.md)]](https://msdn.microsoft.com/library/azure/hh967611.aspx#bkmk_azureportal) y cree o seleccione un directorio existente. Cuando un directorio está disponible siga las instrucciones para [agregar una aplicación](https://docs.microsoft.com/azure/active-directory/develop/active-directory-integrating-applications) al directorio.  

1. En el menú **Aplicaciones** del directorio, seleccione **Agregar**.
2. Elija **Agregue una aplicación que mi organización está desarrollando**.
3. Especifique un **nombre** personalizado para la aplicación y elija el tipo **aplicación web y/o API web**.
4. Para la **Dirección URL de inicio de sesión** y la **URI de Id. de la aplicación**, especifique la dirección URL del portal para los dos campos https://portal.contoso.com/
5. En este punto, se crea una nueva aplicación. Acceda a la sección **Configurar** en el menú.

    En la sección **inicio de sesión único**, actualice la primera entrada **Dirección URL de respuesta** para incluir una ruta en la dirección URL: https://portal.contoso.com/signin-azure-ad. Esto corresponde al valor del parámetro del sitio **RedirectUri**

6. En la sección **propiedades**, busque el campo **Id. de cliente**. Esto corresponde al valor del parámetro del sitio **ClientId**.
7. En el menú de pie de página, seleccione **Ver extremos** y escriba el campo **Documento de metadatos de federación**.

La parte izquierda de la dirección URL es el valor **Entidad** y está en uno de los siguientes formatos:

- https://login.microsoftonline.com/01234567-89ab-cdef-0123-456789abcdef/
- https://login.microsoftonline.com/contoso.onmicrosoft.com/

Para obtener la dirección URL de la configuración de servicio, reemplace la cola de la ruta de FederationMetadata/2007-06/FederationMetadata.xml con la ruta .well-known/openid-configuration. Por ejemplo, <https://login.microsoftonline.com/contoso.onmicrosoft.com/.well-known/openid-configuration>.

Esto corresponde al valor del parámetro del sitio **MetadataAddress**.

### <a name="related-site-settings"></a>Configuración del sitio relacionada

Aplique valores del sitio del portal que hagan referencia a la aplicación anterior.

> [!Note]
> Una configuración de [!INCLUDE[pn-azure-shortest](../../../includes/pn-azure-shortest.md)] AD estándar sólo usa los siguientes valores (con valores de ejemplo):                                 
> - Authentication/OpenIdConnect/[!INCLUDE[pn-azure-shortest](../../../includes/pn-azure-shortest.md)]AD/Authority - <https://login.microsoftonline.com/01234567-89ab-cdef-0123-456789abcdef/>                                                    
> - Authentication/OpenIdConnect/[!INCLUDE[pn-azure-shortest](../../../includes/pn-azure-shortest.md)]AD/ClientId - fedcba98-7654-3210-fedc-ba9876543210                                      
>   El Id. de cliente y la dirección URL de la entidad no tienen el mismo valor y deben recuperarse por separado.           
> - Authentication/OpenIdConnect/[!INCLUDE[pn-azure-shortest](../../../includes/pn-azure-shortest.md)]AD/RedirectUri - https://portal.contoso.com/signin-azure-ad
 
Varios proveedores de identidad pueden configurarse sustituyendo una etiqueta para la etiqueta \[provider\]. Cada etiqueta única forma un grupo de valores relacionados con un proveedor de identidad. Ejemplos: [!INCLUDE[pn-azure-shortest](../../../includes/pn-azure-shortest.md)]AD, MyIdP


|                          Nombre de configuración del sitio                           |                                                                                                                                                                                                         Descripción                                                                                                                                                                                                          |
|----------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|           Authentication/Registration/ExternalLoginEnabled           |                                                                                                                                                                         Habilita o deshabilita el inicio de sesión y el registro de la cuenta externa. Valor predeterminado: true                                                                                                                                                                         |
|         Authentication/OpenIdConnect/\[provider\]/Authority          |                                               Requerido. La entidad a usar al realizar llamadas OpenIdConnect. Ejemplo: `https://login.microsoftonline.com/contoso.onmicrosoft.com/`. Para obtener más información:[OpenIdConnectAuthenticationOptions.Authority](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.authority.aspx).                                                |
|      Authentication/OpenIdConnect/\[provider\]/MetadataAddress       | El extremo de detección para obtener metadatos. Comúnmente termina con la ruta de acceso:/.well-known/openid-configuration. Ejemplo: `https://login.microsoftonline.com/contoso.onmicrosoft.com/.well-known/openid-configuration`. Para obtener más información:[OpenIdConnectAuthenticationOptions.MetadataAddress](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.metadataaddress.aspx). |
|     Authentication/OpenIdConnect/\[provider\]/AuthenticationType     |                                   El tipo de middleware de autenticación OWIN. Especifique el valor del emisor en los metadatos de configuración de servicio. Ejemplo: `https://sts.windows.net/contoso.onmicrosoft.com/`. Para obtener más información: [AuthenticationOptions.AuthenticationType](https://msdn.microsoft.com/library/microsoft.owin.security.authenticationoptions.authenticationtype.aspx).                                   |
|          Authentication/OpenIdConnect/\[provider\]/ClientId          |                                                  Requerido. El valor de Id. de cliente de la aplicación del proveedor. También puede denominarse "Id. de la aplicación "o "Clave de consumidor". Para obtener más información: [OpenIdConnectAuthenticationOptions.ClientId](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.clientid.aspx).                                                   |
|        Authentication/OpenIdConnect/\[provider\]/ClientSecret        |                                              El valor de secreto de cliente de la aplicación del proveedor. También puede denominarse "Secreto de la aplicación "o "Secreto de consumidor". Para obtener más información: [OpenIdConnectAuthenticationOptions.ClientSecret](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.clientsecret.aspx).                                              |
|        Authentication/OpenIdConnect/\[provider\]/RedirectUri         |                                                        Recomendado. El extremo de AD FS WS-Federation Passive. Ejemplo: https://portal.contoso.com/signin-saml2. Para obtener más información: [OpenIdConnectAuthenticationOptions.RedirectUri](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.redirecturi.aspx).                                                        |
|          Authentication/OpenIdConnect/\[provider\]/Caption           |                                                              Recomendado. El texto que el usuario puede mostrar en una interfaz de usuario de inicio de sesión. Predeterminado: \[provider\]. Para obtener más información: [OpenIdConnectAuthenticationOptions.Caption](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.caption.aspx).                                                               |
|          Authentication/OpenIdConnect/\[provider\]/Resource          |                                                                                                       El 'recurso'. Para obtener más información: [OpenIdConnectAuthenticationOptions.Resource](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.resource.aspx).                                                                                                        |
|        Authentication/OpenIdConnect/\[provider\]/ResponseType        |                                                                                                El 'tipo de respuesta\_'. Para obtener más información: [OpenIdConnectAuthenticationOptions.ResponseType](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.responsetype.aspx).                                                                                                 |
|           Authentication/OpenIdConnect/\[provider\]/Scope            |                                                                                Una lista separada por espacios de permisos para solicitar. Predeterminado: openid. Para obtener más información: [OpenIdConnectAuthenticationOptions.Scope](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.scope.aspx).                                                                                 |
|        Authentication/OpenIdConnect/\[provider\]/CallbackPath        |                      Una ruta limitada opcional en la que procesar la devolución de llamada de autenticación. Si no se proporciona y RedirectUri está disponible, este valor se generará desde RedirectUri. Para obtener más información: [OpenIdConnectAuthenticationOptions.CallbackPath](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.callbackpath.aspx).                      |
|     Authentication/OpenIdConnect/\[provider\]/BackchannelTimeout     |                                                                Valor de tiempo de espera para comunicaciones del canal posterior. Ejemplo: 00:05:00 (5 mins). Para obtener más información: [OpenIdConnectAuthenticationOptions.BackchannelTimeout](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.backchanneltimeout.aspx).                                                                |
| Authentication/OpenIdConnect/\[provider\]/RefreshOnIssuerKeyNotFound |                                      Determina si una actualización de metadatos debe intentarse después de una SecurityTokenSignatureKeyNotFoundException. Para obtener más información: [OpenIdConnectAuthenticationOptions.RefreshOnIssuerKeyNotFound](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.refreshonissuerkeynotfound.aspx).                                       |
|      Authentication/OpenIdConnect/\[provider\]/UseTokenLifetime      |                                               Indica que la duración de la sesión de autenticación (por ejemplo, cookies) debe coincidir con la del token de autenticación. Para obtener más información: [OpenIdConnectAuthenticationOptions.UseTokenLifetime](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.usetokenlifetime.aspx).                                               |
|     Authentication/OpenIdConnect/\[provider\]/AuthenticationMode     |                                                                                                     El modo de middleware de autenticación OWIN. Para obtener más información: [AuthenticationOptions.AuthenticationMode](https://msdn.microsoft.com/library/microsoft.owin.security.authenticationoptions.authenticationmode.aspx).                                                                                                     |
| Authentication/OpenIdConnect/\[provider\]/SignInAsAuthenticationType |                                                   El AuthenticationType usado al crear el System.Security.Claims.ClaimsIdentity. Para obtener más información: [OpenIdConnectAuthenticationOptions.SignInAsAuthenticationType](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.signinasauthenticationtype.aspx).                                                   |
|   Authentication/OpenIdConnect/\[provider\]/PostLogoutRedirectUri    |                                                                                 El 'post\_logout\_redirect\_uri'. Para obtener más información: [OpenIdConnectAuthenticationOptions.PostLogoutRedirectUri](https://msdn.microsoft.com/library/microsoft.owin.security.openidconnect.openidconnectauthenticationoptions.postlogoutredirecturi.aspx).                                                                                 |
|       Authentication/OpenIdConnect/\[provider\]/ValidAudiences       |                                                                                                  Lista separada por comas de direcciones URL de la audiencia. Para obtener más información: [TokenValidationParameters.AllowedAudiences](https://msdn.microsoft.com/library/system.identitymodel.tokens.tokenvalidationparameters.allowedaudiences.aspx).                                                                                                  |
|        Authentication/OpenIdConnect/\[provider\]/ValidIssuers        |                                                                                                       Lista separada por comas de direcciones URL del emisor. Para obtener más información: [TokenValidationParameters.ValidIssuers](https://msdn.microsoft.com/library/system.identitymodel.tokens.tokenvalidationparameters.validissuers.aspx).                                                                                                       |
|         Authentication/OpenIdConnect/\[provider\]/ClockSkew          |                                                                                                                                                                                        El desplazamiento del reloj a aplicar al validar horas.                                                                                                                                                                                        |
|       Authentication/OpenIdConnect/\[provider\]/NameClaimType        |                                                                                                                                                                              El tipo de notificación usado por ClaimsIdentity para almacenar la notificación de nombre.                                                                                                                                                                              |
|       Authentication/OpenIdConnect/\[provider\]/RoleClaimType        |                                                                                                                                                                              El tipo de notificación usado por ClaimsIdentity para almacenar la notificación de rol.                                                                                                                                                                              |
|   Authentication/OpenIdConnect/\[provider\]/RequireExpirationTime    |                                                                                                                                                                              Un valor que indica si los tokens deben tener un valor de 'expiración'.                                                                                                                                                                              |
|    Authentication/OpenIdConnect/\[provider\]/RequireSignedTokens     |                                                                                                                               Un valor que indica si un System.IdentityModel.Tokens.SecurityToken xmlns=<https://ddue.schemas.microsoft.com/authoring/2003/5> puede ser válido si no está firmado.                                                                                                                                |
|      Authentication/OpenIdConnect/\[provider\]/SaveSigninToken       |                                                                                                                                                                        Un booleano para controlar si el token original se guarda cuando se crea una sesión.                                                                                                                                                                        |
|       Authentication/OpenIdConnect/\[provider\]/ValidateActor        |                                                                                                                                                            Un valor que indica si el System.IdentityModel.Tokens.JwtSecurityToken.Actor debe validarse.                                                                                                                                                            |
|      Authentication/OpenIdConnect/\[provider\]/ValidateAudience      |                                                                                                                                                                       Un booleano para controlar si el público se validará durante la validación de token.                                                                                                                                                                        |
|       Authentication/OpenIdConnect/\[provider\]/ValidateIssuer       |                                                                                                                                                                        Un booleano para controlar si el emisor se validará durante la validación de token.                                                                                                                                                                         |
|      Authentication/OpenIdConnect/\[provider\]/ValidateLifetime      |                                                                                                                                                                       Un booleano para controlar si la duración se validará durante la validación de token.                                                                                                                                                                        |
|  Authentication/OpenIdConnect/\[provider\]/ValidateIssuerSigningKey  |                                                                                                                  Un valor booleano que controla si se llama a la validación de System.IdentityModel.Tokens.SecurityKey que firmó el securityToken xmlns=<https://ddue.schemas.microsoft.com/authoring/2003/5>.                                                                                                                  |
|                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                              |

## <a name="enable-authentication-using-a-multi-tenant-azure-active-directory-application"></a>Habilitar la autenticación mediante una aplicación de Azure Active Directory multiempresa

Puede configurar su portal para aceptar a usuarios de [!include[](../../../includes/pn-azure-active-directory.md)] de cualquier inquilino en [!include[](../../../includes/pn-azure-shortest.md)] y no solamente un inquilino específico mediante la aplicación multiempresa registrada en [!include[](../../../includes/pn-azure-active-directory.md)]. Para habilitar la multiempresa, establezca el conmutador **Multiempresa** en **Sí** en la aplicación [!include[](../../../includes/pn-azure-active-directory.md)].

![Habilitar arrendamiento múltiple en la aplicación Azure Active Directory](../media/enable-multi-tenancy.png "Habilitar arrendamiento múltiple en la aplicación Azure Active Directory")

### <a name="related-site-settings"></a>Configuración del sitio relacionada

Varios proveedores de identidad pueden configurarse sustituyendo una etiqueta para la etiqueta [provider]. Cada etiqueta única forma un grupo de valores relacionados con un proveedor de identidad. Puede crear o configurar los siguientes valores de sitio en los portales para admitir la autenticación en [!include[](../../../includes/pn-azure-active-directory.md)] con una aplicación multiempresa:

|Nombre de configuración del sitio    |Descripción   |
|---|---|
|Authentication/OpenIdConnect/[provider]/Authority   |La entidad a usar al realizar llamadas OpenIdConnect. Por ejemplo: `https://login.microsoftonline.com/common`   |
|Authentication/OpenIdConnect/[provider]/ClientId   |El valor de Id. de cliente de la aplicación del proveedor. También puede denominarse Id. de la aplicación o Clave de consumidor.   |
|Authentication/OpenIdConnect/[provider]/ExternalLogoutEnabled   |Habilita o deshabilita el cierre de sesión y el registro de la cuenta externa. Establezca este valor como True.   |
|Authentication/OpenIdConnect/[provider]/IssuerFilter   |Un filtro basado en comodín que busca todos los emisores en todos los inquilinos. En la mayoría de los casos, utilice el valor: `https://sts.windows.net/*/`   |
|Authentication/OpenIdConnect/[provider]/RedirectUri  |La ubicación de la URL de respuesta donde el proveedor envía la respuesta de autenticación. Por ejemplo: `https://portal.contoso.com/signin-oidc` |
|Authentication/OpenIdConnect/[provider]/ValidateIssuer   |Un booleano para controlar si el emisor se validará durante la validación de token. Establezca este valor como False.   |
|||

### <a name="see-also"></a>Vea también
[Configurar la autenticación del portal](configure-portal-authentication.md)  
[Establecer identidad de autenticación para un portal](set-authentication-identity.md)  
[Configuración del proveedor OAuth2 para portales](configure-oauth2-settings.md)  
[Configuración de proveedor de WS-Federation para portales](configure-ws-federation-settings.md)  
[Configuración del proveedor SAML 2.0 para portales](configure-saml2-settings.md)  

